# Standalone Single-Machine Stack
# Auto-generated from cluster.yaml
# Runs all services on one machine
#
# Usage:
#   cd docker_configs && docker compose -f docker-compose.standalone.yml up -d

services:
  seaweed-master:
    image: chrislusf/seaweedfs
    container_name: dm_seaweed_master
    restart: unless-stopped
    command: master -ip=seaweed-master -defaultReplication=000
    ports:
    - 9333:9333
    - 19333:19333
    volumes:
    - ../seaweed/master:/data
  seaweed-filer:
    image: chrislusf/seaweedfs
    container_name: dm_seaweed_filer
    restart: unless-stopped
    command: filer -master=seaweed-master:9333 -ip=seaweed-filer
    depends_on:
    - seaweed-master
    - seaweed-volume
    ports:
    - 8888:8888
    - 18888:18888
  seaweed-volume:
    image: chrislusf/seaweedfs
    container_name: dm_seaweed_volume
    restart: unless-stopped
    command: volume -mserver=seaweed-master:9333 -ip=seaweed-volume -dir=/data/seaweed
      -max=100
    depends_on:
    - seaweed-master
    volumes:
    - /data/seaweed/volume:/data/seaweed
  seaweed-mount:
    image: chrislusf/seaweedfs
    container_name: dm_seaweed_mount
    restart: unless-stopped
    command: mount -filer=seaweed-filer:8888 -dir=/mnt/swdshared -filer.path=/
    privileged: true
    devices:
    - /dev/fuse
    cap_add:
    - SYS_ADMIN
    depends_on:
    - seaweed-filer
    volumes:
    - seaweed-data:/mnt/swdshared:shared
volumes:
  seaweed-data: null
  shared-data: null
networks:
  dm-network:
    driver: overlay
    attachable: true
